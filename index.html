<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CineBook — Movie & Event Tickets (Affiliate)</title>
  <meta name="description" content="Find movies & events in your city and book on BookMyShow via our affiliate links." />
  <meta property="og:title" content="CineBook — Movie & Event Tickets" />
  <meta property="og:description" content="Find movies & events in your city and book on BookMyShow via our affiliate links." />
  <meta property="og:type" content="website" />
  <link rel="icon" href="favicon.svg" />
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['ui-sans-serif','system-ui','Inter','Segoe UI','Roboto','Helvetica Neue','Arial','Noto Sans','Apple Color Emoji','Segoe UI Emoji'] }
        }
      }
    }
  </script>
  <style>
    /* Hide template before JS loads */
    [x-cloak]{display:none}
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4">
      <img src="favicon.svg" alt="logo" class="w-8 h-8">
      <h1 class="text-xl font-semibold">CineBook</h1>
      <div class="ml-auto flex items-center gap-2">
        <a href="#" class="text-sm text-gray-600 hover:text-gray-900">About</a>
        <a href="#" class="text-sm text-gray-600 hover:text-gray-900">Contact</a>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 pt-8 pb-24">
    <section class="bg-white rounded-2xl shadow-sm p-6 border">
      <div class="grid md:grid-cols-6 gap-4 items-end">
        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-2">Choose City</label>
          <select id="citySelect" class="w-full rounded-xl border-gray-300 focus:ring-2 focus:ring-black/10 focus:border-gray-500 px-3 py-2">
          </select>
        </div>
        <div class="md:col-span-3">
          <label class="block text-sm font-medium mb-2">Search Movie / Event</label>
          <input id="searchInput" type="text" placeholder="e.g., Stree 2, Deadpool, Garba Night..." class="w-full rounded-xl border-gray-300 focus:ring-2 focus:ring-black/10 focus:border-gray-500 px-3 py-2">
        </div>
        <div class="md:col-span-1">
          <label class="block text-sm font-medium mb-2">Sort</label>
          <select id="sortSelect" class="w-full rounded-xl border-gray-300 focus:ring-2 focus:ring-black/10 focus:border-gray-500 px-3 py-2">
            <option value="popular">Most Popular</option>
            <option value="new">Newest</option>
            <option value="az">A → Z</option>
          </select>
        </div>
      </div>
      <p class="text-xs text-gray-500 mt-3">Note: Bookings are completed on BookMyShow using our affiliate links.</p>
    </section>

    <section class="mt-8">
      <h2 class="text-lg font-semibold mb-4">Now Showing</h2>
      <div id="grid" class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5"></div>
      <div id="emptyState" class="hidden text-center text-gray-500 py-16">No matches found. Try a different search.</div>
    </section>

    <section class="mt-12 bg-white rounded-2xl shadow-sm p-6 border">
      <h3 class="text-base font-semibold mb-2">How it works</h3>
      <ol class="list-decimal list-inside space-y-1 text-sm text-gray-700">
        <li>Pick your <strong>city</strong> and search for a movie/event.</li>
        <li>Click <strong>Book on BookMyShow</strong>.</li>
        <li>You’ll be redirected to BookMyShow via our <strong>affiliate link</strong> to complete purchase.</li>
      </ol>
      <p class="text-xs text-gray-500 mt-3">We may earn a small commission at no extra cost to you.</p>
    </section>
  </main>

  <footer class="border-t">
    <div class="max-w-7xl mx-auto px-4 py-10 text-sm text-gray-600">
      <div class="flex flex-col md:flex-row items-start md:items-center gap-2 md:gap-6">
        <span>&copy; <span id="year"></span> CineBook</span>
        <a href="#" class="hover:text-gray-900">Privacy</a>
        <a href="#" class="hover:text-gray-900">Terms</a>
        <span class="text-xs text-gray-400">Not affiliated with BookMyShow. Trademarks belong to respective owners.</span>
      </div>
    </div>
  </footer>

  <script>
  // ======== CONFIG START ========
  // Paste your default city below (optional)
  const DEFAULT_CITY = "Ahmedabad";

  // If your affiliate network gives a "deep link" wrapper, set it here.
  // Example (Impact): https://YOURPARTNERLINK.abcdefg.net/c/XXXXXX/XXXXXX/1234?subId={YOURSUB}&u=
  // Keep it blank "" if you will paste full affiliate links per item.
  const AFFILIATE_WRAPPER = ""; // leave "" to use item.link as-is

  // ======== SAMPLE DATA ========
  // Edit/replace this data. For each item, you can either:
  // 1) Put a FULL BookMyShow affiliate deep link in `link`, OR
  // 2) Put a normal BMS URL in `link` and use AFFILIATE_WRAPPER (above) which will be prepended and URL-encoded automatically.
  const CITIES = ["Ahmedabad","Surat","Vadodara","Rajkot","Mumbai","Delhi","Bengaluru"];
  const ITEMS = [
    {
      id: "stree-2",
      title: "Stree 2",
      type: "Movie",
      rating: 4.6,
      poster: "https://img.freepik.com/free-photo/cinema-concept-with-clapperboard_23-2147847084.jpg",
      cities: ["Ahmedabad","Surat","Vadodara","Rajkot","Mumbai"],
      releaseDate: "2024-08-15",
      link: "https://in.bookmyshow.com/buytickets/stree-2-mumbai/movie-mumbai-ET00393212-MT/20240819"
    },
    {
      id: "deadpool-wolverine",
      title: "Deadpool & Wolverine",
      type: "Movie",
      rating: 4.5,
      poster: "https://images.unsplash.com/photo-1517602302552-471fe67acf66?q=80&w=1200&auto=format&fit=crop",
      cities: ["Ahmedabad","Surat","Vadodara","Rajkot","Delhi","Mumbai","Bengaluru"],
      releaseDate: "2024-07-26",
      link: "https://in.bookmyshow.com/explore/movies-deadpool-wolverine"
    },
    {
      id: "garba-night",
      title: "Navratri Garba Night",
      type: "Event",
      rating: 4.8,
      poster: "https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop",
      cities: ["Ahmedabad","Surat","Vadodara","Rajkot"],
      releaseDate: "2025-10-01",
      link: "https://in.bookmyshow.com/explore/events-navratri-garba-night"
    },
    {
      id: "pushpa-2",
      title: "Pushpa 2: The Rule",
      type: "Movie",
      rating: 4.7,
      poster: "https://images.unsplash.com/photo-1518893494013-481c1d8ed3fd?q=80&w=1200&auto=format&fit=crop",
      cities: ["Ahmedabad","Surat","Vadodara","Rajkot","Mumbai","Bengaluru"],
      releaseDate: "2024-12-06",
      link: "https://in.bookmyshow.com/explore/movies-pushpa-2"
    }
  ];
  // ======== CONFIG END =========

  function wrapAffiliate(url){
    if(!AFFILIATE_WRAPPER) return url;
    return AFFILIATE_WRAPPER + encodeURIComponent(url);
  }

  function formatDateISO(d){ return new Date(d).toISOString().slice(0,10); }

  function byPopularity(a,b){ return (b.rating||0) - (a.rating||0); }
  function byNewest(a,b){ return new Date(b.releaseDate||0) - new Date(a.releaseDate||0); }
  function byAZ(a,b){ return a.title.localeCompare(b.title); }

  const state = {
    city: DEFAULT_CITY || CITIES[0],
    q: "",
    sort: "popular"
  };

  function initControls(){
    const citySelect = document.getElementById('citySelect');
    CITIES.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c; opt.textContent = c;
      citySelect.appendChild(opt);
    });
    citySelect.value = state.city;
    citySelect.addEventListener('change', () => { state.city = citySelect.value; render(); });

    const q = document.getElementById('searchInput');
    q.addEventListener('input', () => { state.q = q.value.trim().toLowerCase(); render(); });

    const sort = document.getElementById('sortSelect');
    sort.addEventListener('change', () => { state.sort = sort.value; render(); });
  }

  function render(){
    const grid = document.getElementById('grid');
    const empty = document.getElementById('emptyState');
    grid.innerHTML = "";
    let data = ITEMS.filter(it => it.cities.includes(state.city));
    if(state.q){
      data = data.filter(it => (it.title||"").toLowerCase().includes(state.q) || (it.type||"").toLowerCase().includes(state.q));
    }
    if(state.sort === 'popular') data.sort(byPopularity);
    if(state.sort === 'new') data.sort(byNewest);
    if(state.sort === 'az') data.sort(byAZ);

    if(data.length === 0){
      empty.classList.remove('hidden');
      return;
    } else {
      empty.classList.add('hidden');
    }

    data.forEach(it => {
      const card = document.createElement('div');
      card.className = "bg-white border rounded-2xl overflow-hidden shadow-sm hover:shadow transition";
      card.innerHTML = `
        <div class="aspect-[3/4] bg-gray-100 overflow-hidden">
          <img src="${it.poster}" alt="${it.title}" class="w-full h-full object-cover">
        </div>
        <div class="p-4 space-y-2">
          <div class="flex items-center justify-between gap-3">
            <h3 class="font-semibold text-base line-clamp-2">${it.title}</h3>
            <span class="text-xs px-2 py-1 rounded-full bg-gray-100 border">${it.type}</span>
          </div>
          <div class="flex items-center gap-2 text-sm text-gray-600">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <span>${(it.rating || 0).toFixed(1)}</span>
          </div>
          <p class="text-xs text-gray-500">From ${formatDateISO(it.releaseDate || Date.now())}</p>
          <a href="${wrapAffiliate(it.link)}" target="_blank" rel="nofollow noopener" class="inline-flex items-center justify-center w-full mt-2 px-4 py-2 rounded-xl border bg-black text-white hover:opacity-90">
            Book on BookMyShow
          </a>
        </div>
      `;
      grid.appendChild(card);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('year').textContent = new Date().getFullYear();
    initControls();
    render();
  });
  </script>
</body>
</html>
